name: Auto Merge new -> master

on:
  push:
    branches: [ new ]
  workflow_dispatch:

permissions:
  contents: write   # ðŸ‘ˆ required for pushing

# jobs:
#   build-and-test:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4
#       - uses: actions/setup-node@v4
#         with:
#           node-version: '18'
#       - run: npm install
#       - run: npm test

#   merge-to-master:
#     needs: build-and-test
#     runs-on: ubuntu-latest
#     if: success()
#     steps:
#       - name: Checkout master
#         uses: actions/checkout@v4
#         with:
#           ref: master
#           token: ${{ secrets.GITHUB_TOKEN }}

#       - name: Merge new into master
#         run: |
#           git config --global user.name "fauzihazim"
#           git config --global user.email "fauzihazim28@gmail.com"
#           git fetch origin master
#           git branch -a
#           git fetch origin new
#           git branch -a
#           git checkout master

#       - name: 123aa
#         run: |
#           git merge origin/new --allow-unrelated-histories
#           git push origin master
jobs:
  sync_develop:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source branch
        uses: actions/checkout@v4
        with:
          ref: new # Checkout the source branch

      - name: Configure Git
        run: |
          git config user.name "fauzihazim"
          git config user.email "fauzihazim28@gmail.com"

      - name: Merge into target branch
        run: |
          git fetch origin new
          git checkout master
          git reset --hard origin/new
          git push origin master --force
